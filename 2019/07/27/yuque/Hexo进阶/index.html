<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Hexo进阶 | gorquan's Blog</title><meta name="description" content="新增了 Front-matter 写法，网上的例子要不就没人提出来，要不就是有问题的。(2020.05.15)  今天终于下定决心，修复了停止访问已久的博客。自从把环境从 Windows 换到 MacOS 再换到 Ubuntu 后，我原来的博客环境早已不见。原来是采用本地写作然后 hexo d 推送到 Coding 的，但是环境不见了，自然也没有办法推送文章上去。 (办法是有的，我懒——) 所以"><meta name="keywords" content="Hexo"><meta name="author" content="gorquan"><meta name="copyright" content="gorquan"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="https://gorquan-blogs-picture-1251930375.cos.ap-guangzhou.myqcloud.com/avatar.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Hexo进阶"><meta name="twitter:description" content="新增了 Front-matter 写法，网上的例子要不就没人提出来，要不就是有问题的。(2020.05.15)  今天终于下定决心，修复了停止访问已久的博客。自从把环境从 Windows 换到 MacOS 再换到 Ubuntu 后，我原来的博客环境早已不见。原来是采用本地写作然后 hexo d 推送到 Coding 的，但是环境不见了，自然也没有办法推送文章上去。 (办法是有的，我懒——) 所以"><meta name="twitter:image" content="https://gorquan-blogs-picture-1251930375.cos.ap-guangzhou.myqcloud.com/hexo.png"><meta property="og:type" content="article"><meta property="og:title" content="Hexo进阶"><meta property="og:url" content="http://blog.gorquan.cn/2019/07/27/yuque/Hexo%E8%BF%9B%E9%98%B6/"><meta property="og:site_name" content="gorquan's Blog"><meta property="og:description" content="新增了 Front-matter 写法，网上的例子要不就没人提出来，要不就是有问题的。(2020.05.15)  今天终于下定决心，修复了停止访问已久的博客。自从把环境从 Windows 换到 MacOS 再换到 Ubuntu 后，我原来的博客环境早已不见。原来是采用本地写作然后 hexo d 推送到 Coding 的，但是环境不见了，自然也没有办法推送文章上去。 (办法是有的，我懒——) 所以"><meta property="og:image" content="https://gorquan-blogs-picture-1251930375.cos.ap-guangzhou.myqcloud.com/hexo.png"><meta property="article:published_time" content="2019-07-27T23:45:14.000Z"><meta property="article:modified_time" content="2021-06-10T03:05:15.860Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="http://blog.gorquan.cn/2019/07/27/yuque/Hexo%E8%BF%9B%E9%98%B6/"><link rel="prev" title="Ubuntu下NVIDIA显卡驱动处理" href="http://blog.gorquan.cn/2019/07/29/yuque/Ubuntu%E4%B8%8BNVIDIA%E6%98%BE%E5%8D%A1%E9%A9%B1%E5%8A%A8%E5%A4%84%E7%90%86/"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-133966066-1', 'auto');
ga('send', 'pageview');
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://blogs.gorquan.cn/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: {"languages":{"author":"作者: gorquan","link":"链接: ","source":"来源: gorquan's Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-right"},
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="referrer" content="no-referrer" /><meta name="generator" content="Hexo 5.0.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><canvas class="fireworks"></canvas><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://gorquan-blogs-picture-1251930375.cos.ap-guangzhou.myqcloud.com/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">23</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">22</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">24</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E9%9B%80-Serverless-Travis-CI-Github-Pages-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88"><span class="toc-number">1.</span> <span class="toc-text">语雀 + Serverless + Travis CI + Github Pages 部署方案</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2%E7%8E%AF%E5%A2%83"><span class="toc-number">1.1.</span> <span class="toc-text">部署环境</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B6%89%E5%8F%8A%E6%8A%80%E6%9C%AF"><span class="toc-number">1.2.</span> <span class="toc-text">涉及技术</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-Nodejs-%E5%92%8C-Npm"><span class="toc-number">1.3.</span> <span class="toc-text">安装 Nodejs 和 Npm</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE-Hexo"><span class="toc-number">1.4.</span> <span class="toc-text">安装与配置 Hexo</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE-Suka-%E4%B8%BB%E9%A2%98"><span class="toc-number">1.5.</span> <span class="toc-text">安装与配置 Suka 主题</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E4%BB%93%E5%BA%93"><span class="toc-number">1.6.</span> <span class="toc-text">创建仓库</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-Travis-CI"><span class="toc-number">1.7.</span> <span class="toc-text">配置 Travis CI</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%92%8C%E9%85%8D%E7%BD%AE%E8%AF%AD%E9%9B%80%E7%9F%A5%E8%AF%86%E5%BA%93"><span class="toc-number">1.8.</span> <span class="toc-text">创建和配置语雀知识库</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-Serverless"><span class="toc-number">1.9.</span> <span class="toc-text">配置 Serverless</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8F%90%E4%BA%A4%E4%BB%A3%E7%A0%81%E5%88%B0-Hexo-source-%E4%BB%93%E5%BA%93"><span class="toc-number">1.10.</span> <span class="toc-text">提交代码到 Hexo source 仓库</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-HTTPS-%E5%92%8C-CNAME-%E4%BB%A5%E8%BF%9B%E8%A1%8C%E5%9B%BA%E5%AE%9A%E5%9F%9F%E5%90%8D"><span class="toc-number">1.11.</span> <span class="toc-text">配置 HTTPS 和 CNAME 以进行固定域名</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%A7%E5%8A%9F%E5%91%8A%E6%88%90"><span class="toc-number">1.12.</span> <span class="toc-text">大功告成</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Front-matter-%E5%8A%9F%E8%83%BD"><span class="toc-number">1.13.</span> <span class="toc-text">使用 Front-matter 功能</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81"><span class="toc-number">2.</span> <span class="toc-text">源码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">3.</span> <span class="toc-text">参考</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E5%B0%BE"><span class="toc-number">4.</span> <span class="toc-text">结尾</span></a></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://gorquan-blogs-picture-1251930375.cos.ap-guangzhou.myqcloud.com/hexo.png)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">gorquan's Blog</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">Hexo进阶</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date" title="发表于 2019-07-28 07:45:14"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-07-28</time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Hexo/">Hexo</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">5.8k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 23 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><blockquote>
<p>新增了 Front-matter 写法，网上的例子要不就没人提出来，要不就是有问题的。(2020.05.15)</p>
</blockquote>
<p>今天终于下定决心，修复了停止访问已久的博客。<br>自从把环境从 Windows 换到 MacOS 再换到 Ubuntu 后，我原来的博客环境早已不见。原来是采用本地写作然后 hexo d 推送到 Coding 的，但是环境不见了，自然也没有办法推送文章上去。 <del>(办法是有的，我懒——)</del> <br>所以，这次修复博客，不仅要解决本地写作问题，还要解决自动部署问题（不想每次都 hexo g &amp;&amp; hexo d)，逛了一遍 Google 和 Github，有以下两个选型</p>
<ol>
<li>采用<a target="_blank" rel="noopener" href="https://github.com/b3log/solo">Solo</a>博客系统</li>
</ol>
<p>这个博客系统满足了我大部分的需求（Markdown 写作，备份..)，但是需要部署在自己的服务器上，国内服务器吧，又不想备案；国外服务器吧，访问又慢；套 Cloudflare 吧，服务器又要钱；最重要的，如果服务器到期了，自己还要重新找一台服务器进行部署，即使提供 docker-compose 方式部署，但是数据还要迁移一次，实在是太麻烦，所以放弃了这个方案。</p>
<ol start="2">
<li>采用语雀 + Serverless + Travis CI + Github Page 实现云端写作，自动构建和自动部署 Hexo 功能</li>
</ol>
<p>这个方案好处就是可以把文章保存在语雀，在语雀发布文章之后可以通过 Serverless 触发 Travis CI 构建并部署到 Github Page 上面，既满足了我写作的需求，又解决了我备份、部署的问题，所以最后采用了这个方案。下面给各位看官介绍一下整个部署过程，不用找遍整个谷歌东拼西凑才弄清整个脉络。<br>（这里不得不吐槽下国内圈子的氛围，不把步骤写全这个情有可原，但是解决 problem 的博客都不约而同的一致，你们复制的那么开心的吗？）<br>废话不多说，下面开始介绍整个过程。本文较长，也需要较强的动手能力。</p>
<hr>
<h4 id="语雀-Serverless-Travis-CI-Github-Pages-部署方案"><a href="#语雀-Serverless-Travis-CI-Github-Pages-部署方案" class="headerlink" title="语雀 + Serverless + Travis CI + Github Pages 部署方案"></a>语雀 + Serverless + Travis CI + Github Pages 部署方案</h4><ol>
<li><a href="#C4X70">部署环境</a></li>
<li><a href="#pHfMy">涉及技术</a></li>
<li><a href="#YkFbm">安装 Nodejs 和 Npm</a></li>
<li><a href="#xhneP">安装与配置 Hexo</a></li>
<li><a href="#dpjKp">配置与安装 Suka 主题</a></li>
<li><a href="#EecVl">创建仓库</a></li>
<li><a href="#TJtIn">配置 Travis CI</a></li>
<li><a href="#mtpJA">创建和配置语雀知识库</a></li>
<li><a href="#OzsX9">配置 Serverless</a></li>
<li><a href="#KXmVl">提交代码到 Hexo Source 仓库</a></li>
<li><a href="#Axcw7">配置 HTTPS 和 CNAME 以进行固定域名</a></li>
<li><a href="#T2Uwu">大功告成</a></li>
</ol>
<h5 id="部署环境"><a href="#部署环境" class="headerlink" title="部署环境"></a>部署环境</h5><ul>
<li>Ubuntu 18.04，其他系统请自行摸索，思路类似。</li>
</ul>
<h5 id="涉及技术"><a href="#涉及技术" class="headerlink" title="涉及技术"></a>涉及技术</h5><ul>
<li>语雀</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.yuque.com/">语雀</a>，写文章的平台，能够保存和发布文章</p>
<ul>
<li>yuque-hexo</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://github.com/x-cold/yuque-hexo">语雀知识库同步工具</a>，需要通过这个工具才能获取到语雀知识库上的文章</p>
<ul>
<li>Serverless</li>
</ul>
<p>无服务器云函数，腾讯和阿里都提供 <code>Serverless</code>  服务，此处我使用腾讯云的 <del>（老用户了）</del></p>
<ul>
<li>Travis CI</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://travis-ci.org/">Travis CI</a>提供持续集成服务，换句话说，他可以帮助你构建并部署 <code>Hexo</code>  和文章到 <code>Github Page</code>  上</p>
<ul>
<li>Nodejs</li>
</ul>
<p><code>Hexo</code>  必要的环境</p>
<ul>
<li>Npm</li>
</ul>
<p>用于安装 <code>Hexo</code>  和一些主题所需要的依赖包</p>
<ul>
<li>Hexo</li>
</ul>
<p>博客系统</p>
<ul>
<li>Suka</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://theme-suka.skk.moe/">suka</a>，Hexo 主题 ，提供的功能挺全的，整体很简洁。</p>
<ul>
<li>Github</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://github.com/">Github</a>，Hexo 载体，通过访问 <code>Github Page</code>  地址展示你的博客</p>
<ul>
<li>PHP</li>
</ul>
<p>用于构建 <code>Serverless</code>  函数</p>
<ul>
<li>Git</li>
</ul>
<p>用于提交代码到 <code>Github</code> ，让 <code>Travis CI</code>  自动构建</p>
<h5 id="安装-Nodejs-和-Npm"><a href="#安装-Nodejs-和-Npm" class="headerlink" title="安装 Nodejs 和 Npm"></a>安装 Nodejs 和 Npm</h5><blockquote>
<p>此处安装仅适用于 LInux（Ubuntu 18.04 已测试通过），MacOS 和 Windows 请自行探索安装方法</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> curl -sL https://deb.nodesource.com/setup_12.x | sudo -E bash -</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sudo apt install nodejs</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> nodejs --version</span></span><br><span class="line">v12.10.0 # 2019.10.21 更新</span><br><span class="line"><span class="meta">$</span><span class="bash"> npm --version</span></span><br><span class="line">6.10.3 # 2019.10.21 更新</span><br></pre></td></tr></table></figure>

<p>注：(1). 目前最新版本为 <code>v12.10.0</code> ，后面有更新请访问<a target="_blank" rel="noopener" href="https://deb.nodesource.com/">nodesource</a>获取最新命令（2019.10.21 更新）<br>(2). 安装 <code>nodejs</code>  同时安装 <code>npm</code> <br>(3). 如果 <code>npm</code>  访问过慢，可以使用 <code>cnpm</code>  代替</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install -g cnpm --registry=https://registry.npm.taobao.org</span></span><br></pre></td></tr></table></figure>

<p>至此， <code>nodejs</code>  和 <code>npm</code>  安装完成，下面开始安装和配置 <code>Hexo</code></p>
<h5 id="安装与配置-Hexo"><a href="#安装与配置-Hexo" class="headerlink" title="安装与配置 Hexo"></a>安装与配置 Hexo</h5><p>安装步骤：</p>
<ol>
<li>安装 <code>hexo-cli</code></li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install -g hexo-cli</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>生成 <code>Hexo</code>  源码</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> $ hexo init &lt;folder&gt; 初始化命令</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo init ~/blog</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> ~/blog</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm install</span></span><br></pre></td></tr></table></figure>

<p>注：(1). 博客目录此处定义为 <code>~/blog</code> <br>(2). 增加部分依赖，防止 <code>Travis CI</code>  构建时报错</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install --save hexo-deployer-git</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm install --save hexo-util</span></span><br></pre></td></tr></table></figure>

<p>至此， <code>Hexo</code>  安装完成，下面为 <code>Hexo</code>  配置。</p>
<ol>
<li>配置站点 <code>_config.yaml</code></li>
</ol>
<p>添加 <code>git</code> ，即添加 <code>Hexo page</code>  仓库地址，让 <code>Travis CI</code>  构建后 push 到 <code>Hexo page</code>  进行展示</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/blog</span><br><span class="line"><span class="meta">$</span><span class="bash"> vi _config.yaml</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Deployment</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Docs: https://hexo.io/docs/deployment.html</span></span></span><br><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line"><span class="meta">  #</span><span class="bash"> repo: git@github.com:your github name/your hexo page repo name</span></span><br><span class="line"><span class="meta">  #</span><span class="bash"> 此处repo地址要与你的Hexo page仓库地址一致</span></span><br><span class="line">  repo: git@github.com:gorquan/gorquan.github.io.git</span><br></pre></td></tr></table></figure>

<p>其他配置请参考<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/configuration">Hexo 官方配置</a>，个人站点配置文件<a target="_blank" rel="noopener" href="https://github.com/gorquan/blog/blob/master/_config.yml">_config.yaml</a></p>
<p>至此，已经安装 <code>Hexo</code>  框架并配置完成，下面进行 <code>Suka</code>  主题安装与配置。</p>
<h5 id="安装与配置-Suka-主题"><a href="#安装与配置-Suka-主题" class="headerlink" title="安装与配置 Suka 主题"></a>安装与配置 Suka 主题</h5><p>此处安装有两种方式，一种是从<a target="_blank" rel="noopener" href="https://github.com/SukkaW/hexo-theme-suka/releases/latest">release 页面</a>下载解压到 <code>~/blog/themes</code>  下，一种是使用 <code>git</code>  将主题代码同步<br>此处介绍使用 <code>git</code>  同步主题代码方式。至于从 <code>release页面</code>  下载，请详细看主题文档。其他主题文档请阅读主题文档。</p>
<ol>
<li>同步主题</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> ~/blog/themes</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">clone</span> https://github.com/SukkaW/hexo-theme-suka.git suka</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> suka</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>安装主题</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/blog/themes/suka</span><br><span class="line"><span class="meta">$</span><span class="bash"> npm install --production</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>生成主题配置文件 <code>_config.yml</code></li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/blog/themes/suka</span><br><span class="line"><span class="meta">$</span><span class="bash"> cp -i _config.example.yml _config.yml</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>添加站点配置文件 <code>_config.yml</code></li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/blog</span><br><span class="line"><span class="meta">$</span><span class="bash"> cat themes/suka/site_config.yml &gt;&gt; _config.yml</span></span><br></pre></td></tr></table></figure>

<p>注：(1). 作者说主题已经安装 <code>qr-image</code> 、 <code>node-prismjs</code> 、 <code>json-stringify-safe</code> ，但是在 <code>Travis CI</code>  构建中，会出现找不到 module 错误，因此需要在 <code>源码根目录</code>  下安装这三个包</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/blog</span><br><span class="line"><span class="meta">$</span><span class="bash"> npm install --save node-prismjs</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm install --save qr-image</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm install --save json-stringify-safe</span></span><br></pre></td></tr></table></figure>

<p>(2). 在源码根目录安装完这三个依赖后， <code>hexo s</code>  本地运行出现 <code>Fatal error: ENOSPC: System limit for number of file watchers reached, watch</code>  错误，解决方法如下</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">echo</span> fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf &amp;&amp; sudo sysctl -p</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sudo sysctl --system</span></span><br></pre></td></tr></table></figure>

<p>至此， <code>suka</code>  主题安装完成，下面为 <code>suka</code>  主题配置。</p>
<ol>
<li>启用主题</li>
</ol>
<p>修改站点配置文件 <code>_config.yml</code>  中的  <code>theme</code>  值为 <code>suka</code> （主题文件夹名字）</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/blog</span><br><span class="line"><span class="meta">$</span><span class="bash"> vi _config.yml</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Extensions</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Plugins: https://hexo.io/plugins/</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Themes: https://hexo.io/themes/</span></span></span><br><span class="line">theme: suka</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>配置主题的  <code>_config.yaml</code></li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/blog</span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> themes</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> suka</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/blog/themes/suka</span><br><span class="line"><span class="meta">$</span><span class="bash"> vi _config.yaml</span></span><br></pre></td></tr></table></figure>

<p>其他配置请参考<a target="_blank" rel="noopener" href="https://theme-suka.skk.moe/docs/">suka 官方配置</a>，个人主题<a target="_blank" rel="noopener" href="https://github.com/gorquan/blog/blob/master/themes/suka/_config.yaml">_config.yaml</a></p>
<p>至此， <code>Suka</code>  主题配置完成，下面建立 <code>Hexo source</code>  仓库与 <code>Hexo page</code>  仓库并配置 <code>Github Pages</code> 。</p>
<h5 id="创建仓库"><a href="#创建仓库" class="headerlink" title="创建仓库"></a>创建仓库</h5><p>创建两个仓库，一个仓库储存 Hexo 源代码 <code>Hexo source</code> ，一个仓库储存 Hexo 生成的页面 <code>Hexo page</code> 。也可以使用同一个仓库，使用不同分支。此处使用两个仓库的方案。</p>
<ol>
<li>创建 Hexo Source 仓库</li>
</ol>
<ul>
<li>登录 <code>Github</code>  后，点击右上角 <code>+</code> -&gt; <code>New repository</code></li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1571643050871-cf47c1f2-5939-4dfe-8a32-62bd1ce18eba.png#align=left&display=inline&height=269&margin=%5Bobject%20Object%5D&name=image.png&originHeight=269&originWidth=1839&size=79507&status=done&style=none&width=1839" alt="image.png"></p>
<ul>
<li>跳转到创建页面后，输入仓库信息，然后点击 <code>Create repository</code> ，创建仓库</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1571643212696-250d7281-68e7-4656-bbfc-18f552e9b419.png#align=left&display=inline&height=699&margin=%5Bobject%20Object%5D&name=image.png&originHeight=699&originWidth=1097&size=83415&status=done&style=none&width=1097" alt="image.png"></p>
<p>注意：仓库一定要选择 <code>Public</code> ，不然 <code>Travis CI</code>  会弄得很麻烦。对于 <code>README</code>  和 <code>.gitignore</code> ，可以初始化也可以不初始化</p>
<ol start="2">
<li>创建 Hexo page 仓库</li>
</ol>
<p>此步与创建 <code>Hexo Source</code>  仓库步骤一致，因此不再详细说明，可以参考创建 <code>Hexo Source</code>  仓库步骤。要注意的是，仓库不能为个人私仓，因为要使用 <code>Github Pages</code>  功能。</p>
<ol start="3">
<li>配置 Hexo page 仓库</li>
</ol>
<p>需要部署 <code>SSH公钥</code> ，以便 <code>Travis CI</code>  构建完成能够 push 代码到 <code>Hexo page</code>  仓库。</p>
<ol>
<li>生成 <code>SSH公钥</code>  和 <code>SSH私钥</code></li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ssh-keygen -t rsa -C <span class="string">&quot;youremail@example.com&quot;</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/.ssh</span><br><span class="line"><span class="meta">$</span><span class="bash"> ls</span></span><br><span class="line">id_rsa.pub id_rsa</span><br><span class="line"><span class="meta">$</span><span class="bash"> cat id_rsa.pub</span></span><br><span class="line">ssh-rsa xxxxxx youremail@example.com</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>依次点开 <code>Hexo page</code>  仓库-&gt; <code>Settings</code> -&gt; <code>Deploy keys</code> -&gt; <code>Add deploy key</code></li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1564318448155-deffd034-d231-4530-94f8-67645ebf1318.png#align=left&display=inline&height=483&margin=%5Bobject%20Object%5D&name=DeepinScreenshot_select-area_20190728204311.png&originHeight=483&originWidth=1029&size=72895&status=done&style=none&width=1029" alt="DeepinScreenshot_select-area_20190728204311.png"></p>
<p>把 <code>id_rsa.pub</code>  的内容复制到 <code>Key</code>  中，注意要勾选上 <code>Allow write access</code> ，不然 <code>Travis CI</code>  无法 push 代码。点 <code>Add key</code>  完成添加。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1564318481350-aa2e305f-0871-48ca-a66f-55eb7a029935.png#align=left&display=inline&height=603&margin=%5Bobject%20Object%5D&name=DeepinScreenshot_select-area_20190728204513.png&originHeight=603&originWidth=1097&size=67704&status=done&style=none&width=1097" alt="DeepinScreenshot_select-area_20190728204513.png"></p>
<p>至此， <code>Hexo page</code>  仓库配置完毕，下面开始配置 <code>Travis CI</code> 。</p>
<h5 id="配置-Travis-CI"><a href="#配置-Travis-CI" class="headerlink" title="配置 Travis CI"></a>配置 Travis CI</h5><ol>
<li>进入<a target="_blank" rel="noopener" href="https://travis-ci.org/">Travis CI 官网</a>，使用 <code>Github</code>  账号授权登录</li>
<li>授权登录后，会自动同步你的 <code>Github 仓库</code> ，如果你没有看到你建立的 <code>Hexo source</code>  的仓库，点 <code>Sync account</code>  重新同步。找到你的 <code>Hexo source</code>  的仓库，打开右边的按钮。</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1564320873084-b24a830f-af7c-4fd2-9d48-1cd326874d77.png#align=left&display=inline&height=633&margin=%5Bobject%20Object%5D&name=DeepinScreenshot_select-area_20190728213127.png&originHeight=633&originWidth=1154&size=84310&status=done&style=none&width=1154" alt="DeepinScreenshot_select-area_20190728213127.png"></p>
<ol start="3">
<li>找到 <code>Hexo source</code>  仓库，点击 <code>Settings</code> ，进入设置页面，设置构建选项，打开 <code>Build pushed branches</code>  和 <code>Build pushed pull requests</code>  选项</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1564332101925-d67f5550-f8e4-44b5-bb41-79afd5d5cf69.png#align=left&display=inline&height=648&margin=%5Bobject%20Object%5D&name=DeepinScreenshot_select-area_20190729004127.png&originHeight=648&originWidth=1855&size=80903&status=done&style=none&width=1855" alt="DeepinScreenshot_select-area_20190729004127.png"></p>
<p>4.  在源码创建 <code>.travis</code>  文件夹并将 <code>id_rsa</code>  复制到 <code>.travis</code>  文件夹内</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/blog</span><br><span class="line"><span class="meta">$</span><span class="bash"> mkdir .travis</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> cp ~/.ssh/id_rsa ./.travis</span></span><br></pre></td></tr></table></figure>

<ol start="5">
<li>安装 <code>travis命令行工具</code> ，并使用 <code>命令行</code>  登录 <code>travis</code> 。登录的 <code>用户名</code>  为 <code>github用户名</code> ， <code>密码</code>  为 <code>github密码</code></li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> gem install travis</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> travis login --auto</span></span><br></pre></td></tr></table></figure>

<p>注：gem 需要安装 <code>ruby</code> ，此处错误已经找不到终端记录了，有朋友遇到的解决不了的留言一下</p>
<ol start="6">
<li>使用 <code>travis</code>  加密 <code>id_rsa</code> ，加密后删除 <code>id_rsa</code> ,保留 <code>id_rsa.env</code></li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> .travis</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/blog/.travis</span><br><span class="line"><span class="meta">$</span><span class="bash"> travis encrypt-file id_rsa --add -r owner/repo</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> $ travis encrypt-file id_rsa --add -r gorquan/blog</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> rm -rf id_rsa</span></span><br></pre></td></tr></table></figure>

<p>注：(1). 网上的版本都说终端会出现 <code>openssl aes-256-cbc -K $encrypted_xxxxxxxxxxx_key -iv $encrypted_xxxxxxxxxxx_iv</code> ，但是我生成很多次都没提示这行代码。无关要紧，如果你的代码根目录下面有 <code>.travis.yml</code>  文件，那么会把这行代码添加到 <code>.travis.yml</code> 。如果你的代码根目录下面没有 <code>.travis.yml</code>  文件的话，可以在 <code>Travis CI</code>  的 <code>Hexo source仓库</code>  的 <code>Settings</code>  里获取 <code>encrypted_xxxxxxxxxxx_key</code>  和 <code>encrypted_xxxxxxxxxxx_iv</code></p>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1564367450112-a3ff7c9c-a698-4ad4-a02d-6c7ddf93f622.png#align=left&display=inline&height=676&margin=%5Bobject%20Object%5D&name=WeChat%20Image_20190729103025.png&originHeight=676&originWidth=923&size=62063&status=done&style=none&width=923" alt="WeChat Image_20190729103025.png"></p>
<p>(2). 因为此处源码目录还没提交到 <code>Hexo source</code>  仓库，直接使用 <code>travis encrypt-file id_rsa --add</code>  会发生错误，需要指定仓库，因此使用 <code>travis encrypt-file id_rsa -add -r owner/repo</code>  指定仓库并生成 <code>id_rsa.env</code> （ <code>owner</code>  为 <code>Github</code>  用户名， <code>repo</code>  为 <code>Hexo source</code>  名字）,如果已经将源码提交到 <code>Hexo source</code> ，则直接使用 <code>travis encrypt-file id_rsa --add</code></p>
<ol start="7">
<li>在 <code>.travis</code>  文件夹下创建 <code>ssh_config</code> ，使用 <code>git</code>  默认链接 <code>SSH</code></li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/blog/.travis</span><br><span class="line"><span class="meta">$</span><span class="bash"> touch ssh_config</span></span><br><span class="line">Host github.com</span><br><span class="line">    User git</span><br><span class="line">  StrictHostKeyChecking no</span><br><span class="line">  IdentityFile ~/.ssh/id_rsa</span><br><span class="line">  IdentitiesOnly yes</span><br></pre></td></tr></table></figure>

<p>注：个人<a target="_blank" rel="noopener" href="https://github.com/gorquan/blog/blob/master/.travis/ssh_config">ssh_config</a>配置</p>
<ol start="8">
<li>在源码根目录创建 <code>.travis.yml</code> ，将上面获取的 <code>encrypted_xxxxxxxxxx_key</code>  和 <code>encrypted_xxxxxxxxxx_iv</code>  填入代码</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/blog</span><br><span class="line"><span class="meta">$</span><span class="bash"> touch .travis.yml</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> vi .travis.yml</span></span><br><span class="line"></span><br><span class="line">language: node_js</span><br><span class="line">sudo: false</span><br><span class="line">node_js:</span><br><span class="line">- 12.7.0</span><br><span class="line">branches:</span><br><span class="line">  only:</span><br><span class="line">  - master</span><br><span class="line">before_install:</span><br><span class="line">- openssl aes-256-cbc -K $encrypted_xxxxxxxxxx_key -iv $encrypted_xxxxxxxxxx_iv</span><br><span class="line">  -in .travis/id_rsa.enc -out ~/.ssh/id_rsa -d</span><br><span class="line">- chmod 600 ~/.ssh/id_rsa</span><br><span class="line">- eval $(ssh-agent)</span><br><span class="line">- ssh-add ~/.ssh/id_rsa</span><br><span class="line">- cp .travis/ssh_config ~/.ssh/config</span><br><span class="line">- git config --global user.name &#x27;yourname&#x27;</span><br><span class="line">- git config --global user.email youremail@example.com</span><br><span class="line">install:</span><br><span class="line">- npm install hexo-cli -g</span><br><span class="line">- npm install</span><br><span class="line">script:</span><br><span class="line">- cross-env YUQUE_TOKEN=$yuque_token npm run deploy # 2019.10.21更新为使用token，该token为语雀token，下面会用到</span><br></pre></td></tr></table></figure>

<p>注：(1).  需要注意，文件是 <code>.travis.yml</code> ，不是 <code>.travis.yaml</code> ，如果文件为 <code>.travis.yaml</code> ， <code>Travis CI</code>  不能识别文件，把他当做 ruby 项目进行构建<br>(2). 个人<a target="_blank" rel="noopener" href="https://github.com/gorquan/blog/blob/master/.travis.yml">.travis.yml</a>配置<br>(3). 根据<a target="_blank" rel="noopener" href="https://segmentfault.com/u/acwong">ac 黄</a>老哥的说法，可以用 <code>cache</code>  对 <code>node_modules</code>  进行缓存，减少 <code>npm install</code>  安装时间</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/blog</span><br><span class="line"><span class="meta">$</span><span class="bash"> touch .travis.yml</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> vi .travis.yml</span></span><br><span class="line">cache:</span><br><span class="line">  directories:</span><br><span class="line">    - node_modules</span><br></pre></td></tr></table></figure>

<ol start="9">
<li>获取 <code>Travis CI</code>  的 <code>账户token</code> ，点用户 <code>Setting</code> ，进入设置页面，点 <code>Setting</code> ，在 <code>API authentication</code>  处点击 <code>copy token</code> ，获取 <code>token</code></li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1564331864232-859327a3-32fe-48e9-8599-423daa07babe.png#align=left&display=inline&height=638&margin=%5Bobject%20Object%5D&name=DeepinScreenshot_select-area_20190729003702.png&originHeight=638&originWidth=1851&size=92219&status=done&style=none&width=1851" alt="DeepinScreenshot_select-area_20190729003702.png"></p>
<ol start="10">
<li>获取仓库 ID</li>
</ol>
<p>此处不使用 <code>postman</code>  获取，而是使用 <code>curl</code>  进行获取。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> curl -H <span class="string">&quot;Travis-API-Version: 3&quot;</span> -H <span class="string">&quot;User-Agent: API Explorer&quot;</span>  -H <span class="string">&quot;Authorization: token xxxxxxxxxxxxxxxxxxx&quot;</span>  https://api.travis-ci.org/owner/owner/repos</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> $ curl -H <span class="string">&quot;Travis-API-Version: 3&quot;</span> -H <span class="string">&quot;User-Agent: API Explorer&quot;</span>  -H <span class="string">&quot;Authorization: token xxxxxxxxxxxxxxxxxxx&quot;</span>  https://api.travis-ci.org/owner/gorquan/repos</span></span><br><span class="line">&#123;</span><br><span class="line">      &quot;@type&quot;: &quot;repository&quot;,</span><br><span class="line">      &quot;@href&quot;: &quot;/repo/xxxxxxxx&quot;,</span><br><span class="line">      &quot;@representation&quot;: &quot;standard&quot;,</span><br><span class="line">      &quot;@permissions&quot;: &#123;</span><br><span class="line">        &quot;read&quot;: true,</span><br><span class="line">        &quot;activate&quot;: true,</span><br><span class="line">        &quot;deactivate&quot;: true,</span><br><span class="line">        &quot;migrate&quot;: false,</span><br><span class="line">        &quot;star&quot;: true,</span><br><span class="line">        &quot;unstar&quot;: true,</span><br><span class="line">        &quot;create_cron&quot;: true,</span><br><span class="line">        &quot;create_env_var&quot;: true,</span><br><span class="line">        &quot;create_key_pair&quot;: true,</span><br><span class="line">        &quot;delete_key_pair&quot;: true,</span><br><span class="line">        &quot;create_request&quot;: true,</span><br><span class="line">        &quot;admin&quot;: true</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: xxxxxxxx, # 此id为仓库ID</span><br><span class="line">      &quot;name&quot;: &quot;blog&quot;,</span><br><span class="line">      &quot;slug&quot;: &quot;gorquan/blog&quot;,</span><br><span class="line">      &quot;description&quot;: &quot;Hexo blog &quot;,</span><br><span class="line">      &quot;github_id&quot;: xxxxxxxxx,</span><br><span class="line">      &quot;github_language&quot;: null,</span><br><span class="line">      &quot;active&quot;: true,</span><br><span class="line">      &quot;private&quot;: false,</span><br><span class="line">      &quot;owner&quot;: &#123;</span><br><span class="line">        &quot;@type&quot;: &quot;user&quot;,</span><br><span class="line">        &quot;id&quot;: xxxxxxx,</span><br><span class="line">        &quot;login&quot;: &quot;gorquan&quot;,</span><br><span class="line">        &quot;@href&quot;: &quot;/user/xxxxxxx&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;default_branch&quot;: &#123;</span><br><span class="line">        &quot;@type&quot;: &quot;branch&quot;,</span><br><span class="line">        &quot;@href&quot;: &quot;/repo/xxxxxxxx/branch/master&quot;,</span><br><span class="line">        &quot;@representation&quot;: &quot;minimal&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;master&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;starred&quot;: false,</span><br><span class="line">      &quot;managed_by_installation&quot;: false,</span><br><span class="line">      &quot;active_on_org&quot;: null,</span><br><span class="line">      &quot;migration_status&quot;: null,</span><br><span class="line">      &quot;history_migration_status&quot;: null</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>注：(1). 将 <code>url</code>  中第二个 <code>owner</code>  改为你 <code>Github</code>  的名字<br>(2). <code>Authorization: token</code>  后加上 <code>Travis CI</code>  的 <code>账户token</code></p>
<p>至此， <code>Travis CI</code>  配置完成，下面创建和配置语雀知识库。</p>
<h5 id="创建和配置语雀知识库"><a href="#创建和配置语雀知识库" class="headerlink" title="创建和配置语雀知识库"></a>创建和配置语雀知识库</h5><ol>
<li>在源码目录安装 <code>yuque-hexo</code></li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/blog</span><br><span class="line"><span class="meta">$</span><span class="bash"> npm install --save yuque-hexo</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>创建知识库，填入 <code>名称</code> 、 <code>简介</code> ， <code>可见范围</code>  选择 <code>互联网可见</code> ，选择 <code>允许搜索引擎收录</code> ，点击 <code>创建</code>  完成创建</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1564330754810-57bb5f5a-d422-47ea-8698-631ecd7092c2.png#align=left&display=inline&height=712&margin=%5Bobject%20Object%5D&name=DeepinScreenshot_select-area_20190729001712.png&originHeight=712&originWidth=1675&size=85185&status=done&style=none&width=1675" alt="DeepinScreenshot_select-area_20190729001712.png"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1564330776407-26ccbbfc-035d-43ac-b1cf-75e501b4e366.png#align=left&display=inline&height=746&margin=%5Bobject%20Object%5D&name=DeepinScreenshot_select-area_20190729001806.png&originHeight=746&originWidth=1853&size=80138&status=done&style=none&width=1853" alt="DeepinScreenshot_select-area_20190729001806.png"></p>
<ol start="3">
<li>进入 <code>知识库</code> ，点击 <code>设置</code>  页面，在基础设置中获取 <code>login</code>  和 <code>repo</code>  的值，其中 <code>login</code>  的值为 1 所指位置的值（nuomici）， <code>repo</code>  的值为 2 所指位置的值（mzb9qp）</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1564330881166-3d16f8f2-22fb-4ec5-a139-a825610b66ad.png#align=left&display=inline&height=772&margin=%5Bobject%20Object%5D&name=DeepinScreenshot_select-area_20190729001846.png&originHeight=772&originWidth=1852&size=50032&status=done&style=none&width=1852" alt="DeepinScreenshot_select-area_20190729001846.png"></p>
<ol start="4">
<li>在 <code>源码根目录</code> ，编辑 <code>package.json</code> ，添加以下代码，把上面获取的 <code>login</code> （nuomici）的值和 <code>repo</code> （mzb9qp）的值填写进去</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/blog</span><br><span class="line"><span class="meta">$</span><span class="bash"> vi package.json</span></span><br><span class="line">&quot;yuqueConfig&quot;: &#123;</span><br><span class="line">    &quot;baseUrl&quot;: &quot;https://www.yuque.com/api/v2&quot;,</span><br><span class="line">    &quot;login&quot;: &quot;xxxxx&quot;,</span><br><span class="line">    &quot;repo&quot;: &quot;xxxxx&quot;,</span><br><span class="line">    &quot;mdNameFormat&quot;: &quot;title&quot;,</span><br><span class="line">    &quot;postPath&quot;: &quot;source/_posts/yuque&quot;</span><br><span class="line"> &#125;,</span><br><span class="line"> &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;sync&quot;: &quot;yuque-hexo sync&quot;,</span><br><span class="line">    &quot;clean:yuque&quot;: &quot;yuque-hexo clean&quot;,</span><br><span class="line">    &quot;deploy&quot;: &quot;npm run sync &amp;&amp; hexo clean &amp;&amp; hexo g -d&quot;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>注：个人<a target="_blank" rel="noopener" href="https://github.com/gorquan/blog/blob/master/package.json">package.json</a>配置</p>
<ol start="5">
<li>处理语雀图片 403 防盗链问题</li>
</ol>
<p>（2019.8.12 更新）<br>最近上一段时间没上 blog，一上 blog 发现图片全部 403 了。然后我纳闷了，又不是用的自己的 CDN，怎么会 403。<br>然后去 <code>yuque-hexo</code>  上面的 <code>issue</code>  看看有没有人提出这样的<a target="_blank" rel="noopener" href="https://github.com/x-cold/yuque-hexo/issues/41">问题</a>，果然也有人遇到了语雀图片防盗链的问题。<br>解决方案:    在 <code>&lt;head&gt;&lt;/head&gt;</code>  中添加以下代码：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;referrer&quot;</span> <span class="attr">content</span>=<span class="string">&quot;no-referrer&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>在 suka 主题中的步骤：<br>在站点目录的 <code>source</code>  文件夹内创建一个名为 <code>_data</code>  的文件夹，并在文件夹内创建名为 <code>head.yml</code>  的文件，并在其中加入以上代码。其他主题请参照帮助文档。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">～/blog</span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> <span class="built_in">source</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/blog/source</span><br><span class="line"><span class="meta">$</span><span class="bash"> mkdir _data</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> _data</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/blog/source/_data</span><br><span class="line">touch head.yml</span><br><span class="line">vi head.yml</span><br><span class="line">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>处理语雀限流导致无法获取文章问题（使用 Token）</li>
</ol>
<p>（2019.10.20 更新）<br>又差不多一个月没写 blog，九月底写文章推送的时候还好好的，到今天（10.20）发表文章的时候突然出问题了。刷新了好久都没看到有文章，肯定是出问题了。上 <code>Travis CI</code>  一看，发现是 <code>yuque-hexo</code>  获取文章的时候出现了问题，报错如下</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Sun, 20 Oct 2019 04:02:06 GMT yuque-hexo deprecated TOKEN of yuque will be required while verion &gt;v1.6.0. at node_modules/yuque-hexo/lib/Downloader.js:38:19</span><br></pre></td></tr></table></figure>

<p>去 <code>yuque-hexo</code>  的 <code>Github</code>  仓库看了一下<a target="_blank" rel="noopener" href="https://github.com/x-cold/yuque-hexo/issues/36">issue</a>，发现也有人有这个问题，而且作者给了明确的答复</p>
<blockquote>
<p>经过验证，这里是被语雀做了限流，所以需要使用你的 Token 来进行请求，具体参考一下 yuque-hexo 的使用文档哈</p>
</blockquote>
<p>好了，要提供 Token 以进行文章获取，知道了问题的解决方案，下面就开始解决吧。注意， <code>yuque-hexo</code>  版本需在 <code>1.6.0</code>  以上，不然用不了 <code>YUQUE_TOKEN</code> 。</p>
<p>搜了一遍 <code>Google</code> ，发现有两种方案</p>
<ul>
<li>修改 <code>根目录</code>  的 <code>package.json</code> ，在 <code>yuqueConfig</code>  中加上语雀账号的 <code>token</code></li>
<li>在 <code>Travis CI</code>  中设置 <code>token</code>  的环境变量，然后使用 <code>cross-env</code>  设置 <code>YUQUE_TOKEN</code>  环境变量。</li>
</ul>
<p>我个人使用了第二种方案，第一种方案好像不起效果，这里就不写出来了，感兴趣的自己去 <code>yuque-hexo</code>  仓库的<a target="_blank" rel="noopener" href="https://github.com/x-cold/yuque-hexo/issues/30">issue</a>里面看吧。下面主要说说第二个方案。</p>
<ol>
<li>在语雀的 <code>账户设置</code>  中，找到 <code>Token</code> ，点击 <code>新建</code> （我这里修复的时候已经新建了一个，默认是没有的）</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1571571758932-dc80d5e9-4074-4953-83cf-c222f786c8df.png#align=left&display=inline&height=263&margin=%5Bobject%20Object%5D&name=image.png&originHeight=263&originWidth=359&size=14782&status=done&style=none&width=359" alt="image.png"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1571571782654-61ab31be-c710-4c2d-8409-ef2f273768e3.png#align=left&display=inline&height=504&margin=%5Bobject%20Object%5D&name=image.png&originHeight=504&originWidth=1112&size=38121&status=done&style=none&width=1112" alt="image.png"></p>
<ol start="2">
<li><code>新建</code>  页面中，在 <code>用途</code>  中输入 token 的名字，在  <code>授权范围</code>  中勾上权限。（我看的那篇文章设置的权限是修改和读取，我个人对权限比较敏感，就设置了只能读取）</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1571573120731-19aa313d-7e05-4b7f-a9ef-19268b295de7.png#align=left&display=inline&height=645&margin=%5Bobject%20Object%5D&name=image.png&originHeight=645&originWidth=1212&size=58591&status=done&style=none&width=1212" alt="image.png"></p>
<ol start="3">
<li>创建好后，会跳转到你创建的 Token 详情页面，复制页面上的 <code>Access Token</code></li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1571573232384-3a1991b6-f350-4cce-a34b-ffd2c26d71ba.png#align=left&display=inline&height=943&margin=%5Bobject%20Object%5D&name=WeChat%20Image_20191020200647.png&originHeight=943&originWidth=1234&size=84092&status=done&style=none&width=1234" alt="WeChat Image_20191020200647.png"></p>
<ol start="4">
<li>去到 <code>Travis CI</code> ，找到你 <code>Hexo page</code>  仓库，在 <code>More Options</code>  下的 <code>Settings</code> ，找到 <code>Environment Variables</code> ，填入 <code>token</code>  和 <code>token</code>  的信息（我这里变量名为 <code>yuque_token</code> ,你可以改为你喜欢的名字），然后点击 <code>Add</code></li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1571573379691-c45c99c4-3f6f-43e4-b8a2-370857f5252c.png#align=left&display=inline&height=342&margin=%5Bobject%20Object%5D&name=WeChat%20Image_20191020200917.png&originHeight=342&originWidth=1517&size=34566&status=done&style=none&width=1517" alt="WeChat Image_20191020200917.png"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1571573412948-4ce3ad69-1e37-46a7-90d3-0629916e6b39.png#align=left&display=inline&height=436&margin=%5Bobject%20Object%5D&name=WeChat%20Image_20191020200952.png&originHeight=436&originWidth=1504&size=47241&status=done&style=none&width=1504" alt="WeChat Image_20191020200952.png"></p>
<ol start="5">
<li>修改 <code>根目录</code>  下的 <code>.travis.yml</code> ,将  <code>npm run deploy</code>  改为 <code>cross-env YUQUE_TOKEN=$yuque_token npm run deploy</code> （如果原来没有 <code>npm run deploy</code>  的直接输入 <code>cross-env YUQUE_TOKEN=$yuque_token npm run deploy</code>  即可)</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pwd</span><br><span class="line">~/blog</span><br><span class="line">vi .travis.yml</span><br></pre></td></tr></table></figure>

<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">script:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">cross-env</span> <span class="string">YUQUE_TOKEN=$yuque_token</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">deploy</span></span><br></pre></td></tr></table></figure>

<ol start="6">
<li>安装 <code>cross-env</code></li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install cross-env</span><br></pre></td></tr></table></figure>

<p>注意：此处需要检查根目录的 <code>package.json</code>  中有没有 <code>cross-env</code> ,如果没有请手动补充上去或者使用 ncu 进行更新（ncu 可以看我另外一篇文章）</p>
<p>至此，语雀知识库配置完成，下面开始配置 Serverless。</p>
<h5 id="配置-Serverless"><a href="#配置-Serverless" class="headerlink" title="配置 Serverless"></a>配置 Serverless</h5><blockquote>
<p>Serverless 我采用的是腾讯云，要用阿里云的看官需要自己去摸索了</p>
</blockquote>
<ol>
<li>登录腾讯云，点 <code>无服务器云函数</code> ，点 <code>新建</code> ，进入 <code>新建函数</code>  界面。在 <code>新建函数</code>  界面填入 <code>函数名称</code> ，运行环境选择 <code>PHP7.2</code> ，模板使用 <code>hello空白函数</code>  模板，然后单击 <code>下一步</code></li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1564328062907-dc8d8379-8935-480a-82f9-80e4d6909f09.png#align=left&display=inline&height=684&margin=%5Bobject%20Object%5D&name=DeepinScreenshot_select-area_20190728233245.png&originHeight=684&originWidth=1696&size=102413&status=done&style=none&width=1696" alt="DeepinScreenshot_select-area_20190728233245.png"></p>
<ol start="2">
<li>输入函数 <code>备注信息</code> ， <code>运行角色</code>  选择 <code>SCF默认运行角色</code> ，然后单击 <code>完成</code></li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1564328214734-69be71ea-9bce-4c27-9e16-aa5f5f607c50.png#align=left&display=inline&height=702&margin=%5Bobject%20Object%5D&name=DeepinScreenshot_select-area_20190728233630.png&originHeight=702&originWidth=1854&size=77594&status=done&style=none&width=1854" alt="DeepinScreenshot_select-area_20190728233630.png"></p>
<ol start="3">
<li>函数创建完成后，进入 <code>函数设置</code> ，点击 <code>函数代码</code> ，将以下代码复制进去，将 <code>Travis CI</code>  配置步骤中获取的 <code>仓库id</code>  填入 <code>$repo</code> ,将 <code>Travis CI</code>  配置步骤中获取的账户 <code>token</code>  填入 <code>$token</code> ，然后单击保存</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main_handler</span>(<span class="params"><span class="variable">$event</span>, <span class="variable">$context</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 解析语雀post的数据</span></span><br><span class="line">    <span class="variable">$update_title</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$event</span>-&gt;body)&#123;</span><br><span class="line">        <span class="variable">$yuque_data</span>= json_decode(<span class="variable">$event</span>-&gt;body);</span><br><span class="line">        <span class="variable">$update_title</span> .= <span class="variable">$yuque_data</span>-&gt;data-&gt;title;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// default params</span></span><br><span class="line">    <span class="variable">$repos</span> = <span class="string">&#x27;xxxxxxx&#x27;</span>;  <span class="comment">// 你的仓库id 或 slug</span></span><br><span class="line">    <span class="variable">$token</span> = <span class="string">&#x27;xxxxxxxxxxxxxxxxxxxxxxxxx&#x27;</span>; <span class="comment">// 你的登录token</span></span><br><span class="line">    <span class="variable">$message</span> = date(<span class="string">&quot;Y/m/d&quot;</span>).<span class="string">&#x27;:yuque update:&#x27;</span>.<span class="variable">$update_title</span>;</span><br><span class="line">    <span class="variable">$branch</span> = <span class="string">&#x27;master&#x27;</span>;</span><br><span class="line">    <span class="comment">// post params</span></span><br><span class="line">    <span class="variable">$queryString</span> = <span class="variable">$event</span>-&gt;queryString;</span><br><span class="line">    <span class="variable">$q_token</span> = <span class="variable">$queryString</span>-&gt;token ? <span class="variable">$queryString</span>-&gt;token : <span class="variable">$token</span>;</span><br><span class="line">    <span class="variable">$q_repos</span> = <span class="variable">$queryString</span>-&gt;repos ? <span class="variable">$queryString</span>-&gt;repos : <span class="variable">$repos</span>;</span><br><span class="line">    <span class="variable">$q_message</span> = <span class="variable">$queryString</span>-&gt;message ? <span class="variable">$queryString</span>-&gt;message : <span class="variable">$message</span>;</span><br><span class="line">    <span class="variable">$q_branch</span> = <span class="variable">$queryString</span>-&gt;branch ? <span class="variable">$queryString</span>-&gt;branch : <span class="string">&#x27;master&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="variable">$q_token</span>);</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&#x27;===&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> (<span class="variable">$q_repos</span>);</span><br><span class="line">    <span class="keyword">echo</span> (<span class="string">&#x27;===&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> (<span class="variable">$q_message</span>);</span><br><span class="line">    <span class="keyword">echo</span> (<span class="string">&#x27;===&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> (<span class="variable">$q_branch</span>);</span><br><span class="line">    <span class="keyword">echo</span> (<span class="string">&#x27;===&#x27;</span>);</span><br><span class="line">    <span class="comment">//request travis ci</span></span><br><span class="line">    <span class="variable">$res_info</span> = triggerTravisCI(<span class="variable">$q_repos</span>, <span class="variable">$q_token</span>, <span class="variable">$q_message</span>, <span class="variable">$q_branch</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$res_code</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$res_message</span> = <span class="string">&#x27;未知&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$res_info</span>[<span class="string">&#x27;http_code&#x27;</span>])&#123;</span><br><span class="line">        <span class="variable">$res_code</span> = <span class="variable">$res_info</span>[<span class="string">&#x27;http_code&#x27;</span>];</span><br><span class="line">        <span class="keyword">switch</span>(<span class="variable">$res_info</span>[<span class="string">&#x27;http_code&#x27;</span>])&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="number">202</span>:</span><br><span class="line">                <span class="variable">$res_message</span> = <span class="string">&#x27;success&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="variable">$res_message</span> = <span class="string">&#x27;faild&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$res</span> = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;status&#x27;</span>=&gt;<span class="variable">$res_code</span>,</span><br><span class="line">        <span class="string">&#x27;message&#x27;</span>=&gt;<span class="variable">$res_message</span></span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* <span class="doctag">@description</span>  travis api , trigger a build</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> $repos string 仓库ID、slug</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> $token string 登录验证token</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> $message string 触发信息</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> $branch string 分支</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span> $info array 回包信息</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">triggerTravisCI</span> (<span class="params"><span class="variable">$repos</span>, <span class="variable">$token</span>, <span class="variable">$message</span>=<span class="string">&#x27;yuque update&#x27;</span>, <span class="variable">$branch</span>=<span class="string">&#x27;master&#x27;</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//初始化</span></span><br><span class="line">    <span class="variable">$curl</span> = curl_init();</span><br><span class="line">    <span class="comment">//设置抓取的url</span></span><br><span class="line">    curl_setopt(<span class="variable">$curl</span>, CURLOPT_URL, <span class="string">&#x27;https://api.travis-ci.org/repo/&#x27;</span>.<span class="variable">$repos</span>.<span class="string">&#x27;/requests&#x27;</span>);</span><br><span class="line">    <span class="comment">//设置获取的信息以文件流的形式返回，而不是直接输出。</span></span><br><span class="line">    curl_setopt(<span class="variable">$curl</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">    <span class="comment">//设置post方式提交</span></span><br><span class="line">    curl_setopt(<span class="variable">$curl</span>, CURLOPT_CUSTOMREQUEST, <span class="string">&quot;POST&quot;</span>);</span><br><span class="line">    <span class="comment">//设置post数据</span></span><br><span class="line">    <span class="variable">$post_data</span> = json_encode(<span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&quot;request&quot;</span>=&gt; <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&quot;message&quot;</span>=&gt;<span class="variable">$message</span>,</span><br><span class="line">            <span class="string">&quot;branch&quot;</span>=&gt;<span class="variable">$branch</span></span><br><span class="line">        )</span><br><span class="line">    ));</span><br><span class="line">    <span class="variable">$header</span> = <span class="keyword">array</span>(</span><br><span class="line">      <span class="string">&#x27;Content-Type: application/json&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;Travis-API-Version: 3&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;Authorization:token &#x27;</span>.<span class="variable">$token</span>,</span><br><span class="line">      <span class="string">&#x27;Content-Length:&#x27;</span> . strlen(<span class="variable">$post_data</span>)</span><br><span class="line">    );</span><br><span class="line">    curl_setopt(<span class="variable">$curl</span>, CURLOPT_HTTPHEADER, <span class="variable">$header</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$curl</span>, CURLOPT_POSTFIELDS, <span class="variable">$post_data</span>);</span><br><span class="line">    <span class="comment">//执行命令</span></span><br><span class="line">    <span class="variable">$data</span> = curl_exec(<span class="variable">$curl</span>);</span><br><span class="line">    <span class="variable">$info</span> = curl_getinfo(<span class="variable">$curl</span>);</span><br><span class="line">    <span class="comment">//关闭URL请求</span></span><br><span class="line">    curl_close(<span class="variable">$curl</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$info</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>点击 <code>触发方式</code> ，添加 <code>触发方式</code> ，将 <code>触发方式</code>  改为 <code>API网关触发器</code> ，然后单击 <code>保存</code></li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1564330005912-11016be4-9eae-43f1-b9a6-1f51628df382.png#align=left&display=inline&height=819&margin=%5Bobject%20Object%5D&name=DeepinScreenshot_select-area_20190729000557.png&originHeight=819&originWidth=1852&size=87221&status=done&style=none&width=1852" alt="DeepinScreenshot_select-area_20190729000557.png"></p>
<ol start="5">
<li>在 <code>触发方式</code>  页面，复制 <code>访问路径</code> ，然后在 <code>语雀知识库</code> -&gt; <code>设置</code> -&gt; <code>开发者设置</code>  里面添加 <code>Web Hook</code> ，把访问路径填进 <code>URL</code> ，选择 <code>所有更新触发</code> ，然后点 <code>添加</code> ，完成添加</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1564367861354-0a9cb7d0-3d8c-4bb1-90c4-4566f696eb8e.png#align=left&display=inline&height=737&margin=%5Bobject%20Object%5D&name=DeepinScreenshot_select-area_20190729103729.png&originHeight=737&originWidth=1851&size=64533&status=done&style=none&width=1851" alt="DeepinScreenshot_select-area_20190729103729.png"><br><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1564330378220-cb71977d-d214-4ac0-88f7-2d6f1c2300a1.png#align=left&display=inline&height=493&margin=%5Bobject%20Object%5D&name=DeepinScreenshot_select-area_20190729001129.png&originHeight=493&originWidth=1856&size=62014&status=done&style=none&width=1856" alt="DeepinScreenshot_select-area_20190729001129.png"></p>
<p>注： <code>访问路径</code>  格式类似以下</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">https://service-rqzwsycg-1251930375.ap-hongkong.apigateway.myqcloud.com/release/xxx</span><br><span class="line"><span class="meta">#</span><span class="bash"> https://service-rqzwsycg-1251930375.ap-hongkong.apigateway.myqcloud.com/release/blog123</span></span><br></pre></td></tr></table></figure>

<p>至此， <code>Serverless</code>  配置完成，接下来只要把代码推送到 Hexo source，Travis CI 即可执行自动构建。</p>
<h5 id="提交代码到-Hexo-source-仓库"><a href="#提交代码到-Hexo-source-仓库" class="headerlink" title="提交代码到 Hexo source 仓库"></a>提交代码到 Hexo source 仓库</h5><p>只需要把博客代码 push 上去即可，建议完成所有配置后再 push 代码。代码 push 到 <code>Hexo source</code>  仓库</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/blog</span><br><span class="line"><span class="meta">$</span><span class="bash"> git init</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git add .</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit -m <span class="string">&quot;your comment message&quot;</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git remote add origin your repo url</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> $ git remote add origin https://github.com/gorquan/blog.git</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git push -u origin master</span></span><br></pre></td></tr></table></figure>

<p>注：如果主题是通过 git 同步下来的， <code>git add .</code>  会出现 <code>fatal:in unpopulated submodule xxx</code>  错误，处理方式如下</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/blog/theme</span><br><span class="line"><span class="meta">$</span><span class="bash"> git rm -rf --cache suka</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git add suka/*</span></span><br></pre></td></tr></table></figure>

<p>代码推送后，等待 <code>Travis CI</code>  进行构建。构建完成后下一步配置 HTTPS 与自定义域名。当然也可以跳过下一步。</p>
<h5 id="配置-HTTPS-和-CNAME-以进行固定域名"><a href="#配置-HTTPS-和-CNAME-以进行固定域名" class="headerlink" title="配置 HTTPS 和 CNAME 以进行固定域名"></a>配置 HTTPS 和 CNAME 以进行固定域名</h5><ol>
<li>在 <code>Hexo Page</code>  仓库，点击 <code>Settings</code> ，点击 <code>Option</code> ，然后往下拉，找到 <code>Github Pages</code> 。如果没有配置 <code>域名</code> ，默认使用 <code>xxxx.github.io</code> ，同时强制 <code>HTTPS</code>  访问</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1564367975626-6d1aa7ad-2e97-44dc-affa-28a4c140f4d3.png#align=left&display=inline&height=738&margin=%5Bobject%20Object%5D&name=DeepinScreenshot_select-area_20190729103927.png&originHeight=738&originWidth=1852&size=80894&status=done&style=none&width=1852" alt="DeepinScreenshot_select-area_20190729103927.png"></p>
<ol start="2">
<li>在 <code>Custom domain</code>  处输入你的域名，点击 <code>Save</code>  保存。等待 <code>证书</code>  签发后，可以使用强制 <code>HTTPS</code> （证书签发需要一定的时间，这段时间可以使用 <code>HTTP</code>  进行访问）</li>
<li>登录域名管理平台（我此处为腾讯云），将你的域名使用 <code>CNAME</code>  解析到 <code>xxxx.github.io</code></li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1564368371088-42c65589-8a02-4d93-ac0d-262a684d80b9.png#align=left&display=inline&height=351&margin=%5Bobject%20Object%5D&name=DeepinScreenshot_select-area_20190729104455.png&originHeight=351&originWidth=1654&size=78823&status=done&style=none&width=1654" alt="DeepinScreenshot_select-area_20190729104455.png"></p>
<ol start="4">
<li><code>Travis CI</code>  构建完成后推送，可能会使 <code>Github Pages</code>  仓库配置覆盖，导致使用自定义域名访问失效（2019.7.30 更新）</li>
</ol>
<p>解决方法，在 <code>source</code>  目录下创建一个 <code>CNAME</code>  文件，里面输入你的 <code>域名</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">~/blog/source</span><br><span class="line"><span class="meta">$</span><span class="bash"> touch CNAME</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> vi CNAME</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> your domain</span></span><br><span class="line">blogs.gorquan.cn</span><br></pre></td></tr></table></figure>

<p>至此，配置 <code>自定义域名</code>  完成，仅需等待你的 <code>HTTPS证书</code>  签发。</p>
<h5 id="大功告成"><a href="#大功告成" class="headerlink" title="大功告成"></a>大功告成</h5><p>你可以在语雀写文章，发布后通过 <code>Serverless</code>  触发 <code>Travis CI</code>  进行自动构建，同步你的语雀文章，并自动部署到你的 <code>Github Pages</code></p>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1564334489905-102b6de1-cf23-4c68-b71e-dbff93d849db.png#align=left&display=inline&height=449&margin=%5Bobject%20Object%5D&name=DeepinScreenshot_select-area_20190729012115.png&originHeight=449&originWidth=1855&size=46840&status=done&style=none&width=1855" alt="DeepinScreenshot_select-area_20190729012115.png"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1564334522913-5c2535d8-92d9-43c8-9a85-fb2e0469dfb6.png#align=left&display=inline&height=618&margin=%5Bobject%20Object%5D&name=DeepinScreenshot_select-area_20190729012153.png&originHeight=618&originWidth=1854&size=85954&status=done&style=none&width=1854" alt="DeepinScreenshot_select-area_20190729012153.png"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/242695/1564334426764-2f6b1604-0c6e-4cf9-a11a-f46f64189878.png#align=left&display=inline&height=678&margin=%5Bobject%20Object%5D&name=DeepinScreenshot_select-area_20190729012015.png&originHeight=678&originWidth=1852&size=65807&status=done&style=none&width=1852" alt="DeepinScreenshot_select-area_20190729012015.png"></p>
<h5 id="使用-Front-matter-功能"><a href="#使用-Front-matter-功能" class="headerlink" title="使用 Front-matter 功能"></a>使用 Front-matter 功能</h5><p>（2020.05.15）<br>默认的写法是没有归类和标签的，但是语雀最后导出来的是 Markdown 文件，所以我们可以在 Markdown 上面添加元信息实现文章分类、文章顶置等功能。下面就展示一下怎么定义元信息，。以本文章作为例子</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">文章题目</span><br><span class="line">tags: [Hexo] # 文章标签</span><br><span class="line">categories: [Hexo] # 文章分类</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">正文信息</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>等 CI 构建并推送到仓库后，就能在 Hexo 上面显示</p>
<p><img src="https://cdn.nlark.com/yuque/0/2020/png/242695/1589551235553-0a2ff9d6-2cd2-4abc-a15e-e9f6a620ede8.png#align=left&display=inline&height=733&margin=%5Bobject%20Object%5D&name=image.png&originHeight=733&originWidth=972&size=530281&status=done&style=none&width=972" alt="image.png"></p>
<p>这个是我测试的一个文章，所以内容和上面定义的有点不太一样，但是效果是一样的。</p>
<p>enjoy~</p>
<h4 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h4><p><a target="_blank" rel="noopener" href="https://github.com/gorquan/gorquan.github.io">页面</a><br><a target="_blank" rel="noopener" href="https://github.com/gorquan/blog">博客源码</a>，求 star！～<br><a target="_blank" rel="noopener" href="https://github.com/gorquan">个人 github</a>，求 follow！～</p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><ul>
<li><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000013266001">https://segmentfault.com/a/1190000013266001</a></li>
<li><a target="_blank" rel="noopener" href="http://researchlab.github.io/2016/05/08/travis-ci-deploy-hexo-blog/">http://researchlab.github.io/2016/05/08/travis-ci-deploy-hexo-blog/</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/4d2edd55b471">https://www.jianshu.com/p/4d2edd55b471</a></li>
<li><a target="_blank" rel="noopener" href="https://www.howtoing.com/how-to-install-node-js-on-ubuntu-18-04">https://www.howtoing.com/how-to-install-node-js-on-ubuntu-18-04</a></li>
<li><a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/setup">https://hexo.io/zh-cn/docs/setup</a></li>
<li><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000004667156#articleHeader5">https://segmentfault.com/a/1190000004667156#articleHeader5</a></li>
<li><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000017797561">https://segmentfault.com/a/1190000017797561</a></li>
<li><a target="_blank" rel="noopener" href="https://medium.com/@desfocado/how-to-get-travis-to-work-with-no-build-language-9f4c03ed68b1">https://medium.com/@desfocado/how-to-get-travis-to-work-with-no-build-language-9f4c03ed68b1</a></li>
<li><a target="_blank" rel="noopener" href="https://theme-suka.skk.moe/docs/">https://theme-suka.skk.moe/docs/</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/zixiao217/article/details/86693854">https://blog.csdn.net/zixiao217/article/details/86693854</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/xs20691718/article/details/81873921">https://blog.csdn.net/xs20691718/article/details/81873921</a></li>
<li><a target="_blank" rel="noopener" href="https://rayleeafar.github.io/2019/01/17/yuque/%E8%AF%A6%E7%BB%86Hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%EF%BC%9A%E4%BA%91%E7%AB%AF%E5%86%99%E4%BD%9C+%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA+%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2/">https://rayleeafar.github.io/2019/01/17/yuque/%E8%AF%A6%E7%BB%86Hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%EF%BC%9A%E4%BA%91%E7%AB%AF%E5%86%99%E4%BD%9C+%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA+%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2/</a><a target="_blank" rel="noopener" href="https://rayleeafar.github.io/2019/01/17/yuque/%E8%AF%A6%E7%BB%86Hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%EF%BC%9A%E4%BA%91%E7%AB%AF%E5%86%99%E4%BD%9C+%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA+%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2/">https://rayleeafar.github.io/2019/01/17/yuque/详细 Hexo 博客搭建：云端写作+自动构建+自动部署/</a></li>
</ul>
<h4 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h4><p>如果文章有不对的地方，欢迎指正～</p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">gorquan</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://blog.gorquan.cn/2019/07/27/yuque/Hexo%E8%BF%9B%E9%98%B6/">http://blog.gorquan.cn/2019/07/27/yuque/Hexo进阶/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://blog.gorquan.cn" target="_blank">gorquan's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Hexo/">Hexo</a></div><div class="post_share"><div class="social-share" data-image="https://gorquan-blogs-picture-1251930375.cos.ap-guangzhou.myqcloud.com/background.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2019/07/29/yuque/Ubuntu%E4%B8%8BNVIDIA%E6%98%BE%E5%8D%A1%E9%A9%B1%E5%8A%A8%E5%A4%84%E7%90%86/"><img class="prev_cover" src="https://gorquan-blogs-picture-1251930375.cos.ap-guangzhou.myqcloud.com/nvidia.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Ubuntu下NVIDIA显卡驱动处理</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2019/10/21/yuque/使用ncu升级Hexo以及其组件/" title="使用ncu升级Hexo以及其组件"><img class="relatedPosts_cover" src="https://gorquan-blogs-picture-1251930375.cos.ap-guangzhou.myqcloud.com/hexo.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-10-21</div><div class="relatedPosts_title">使用ncu升级Hexo以及其组件</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var requestSetting = function (from,set) {
  var from = from
  var setting = set.split(',').filter(function(item){
  return from.indexOf(item) > -1
  });
  setting = setting.length == 0 ? from :setting;
  return setting
}

var guestInfo = requestSetting(['nick','mail','link'],'nick,mail')
var requiredFields = requestSetting(['nick','mail','link'],'nick,mail')

window.valine = new Valine({
  el:'#vcomment',
  appId: 'kxRUuoaHvxEKroNzfsxFskpF-gzGzoHsz',
  appKey: 'tXmjvxCxGHKlOjzQMRSvH2cq',
  notify: false,
  verify: false,
  placeholder: '欢迎留下留言，评论要遵守法律法规哦～',
  avatar: 'monsterid',
  meta: guestInfo,
  pageSize: '10',
  lang: 'zh-CN',
  recordIP: false,
  serverURLs: '',
  emojiCDN: '',
  emojiMaps: "",
  enableQQ: false,
  requiredFields: requiredFields
});</script></div></article></main><footer id="footer" style="background-image: url(https://gorquan-blogs-picture-1251930375.cos.ap-guangzhou.myqcloud.com/hexo.png)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2021 By gorquan</div><div class="framework-info"><span>驱动 </span><a target="_blank" rel="noopener" href="https://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script>var endLoading = function () {
  document.body.style.overflow = 'auto';
  document.getElementById('loading-box').classList.add("loaded")
}
window.addEventListener('load',endLoading)</script></body></html>